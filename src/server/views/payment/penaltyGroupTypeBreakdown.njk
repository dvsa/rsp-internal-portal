{% extends 'layouts/default.layout.njk' %}

{% set pageTitle = 'DVSA Road Side Payment Portal' %}
{% set pageBreadcrumbItems = [
    { text: 'Home', url: '/' },
    { text: paymentCode, url: '/payment-code/' + paymentCode },
    { text: 'Fines' }
  ] 
%}
  
{% block content %}
  {% call components.gridRow() %}
    {% call components.columnTwoThirds() %}
        {% if penaltyType == 'FPN' %}
          {{ components.heading(text='Pay fixed penalties', tag='h1', size='xlarge') }}
        {% elif penaltyType == 'CDN' %}
          {{ components.heading(text='Pay court deposits', tag='h1', size='xlarge') }}
        {% elif penaltyType == 'IM' %}
          {{ components.heading(text='Pay immobilisation fee', tag='h1', size='xlarge') }}
        {% endif %}
      {# Payment summary table #}
      <table>
        <thead>
          <tr>
            <th>Reference</th>
            <th>Amount</th>
            <th>Status</th>
          </tr>
        </thead>
        <tbody>
          {% for penalty in penaltyDetails %}
            {% set statusClass = 'confirmed' if penalty.status == 'PAID' else 'unconfirmed' %}
            <tr>
              <td>{{ penalty.formattedReference }}</td> 
              <td>&pound;{{ penalty.amount }}</td> 
              <td class="{{ statusClass }}"><strong>{{ penalty.status }}</strong></td>
            </tr>   
          {% endfor %}
          {% if penaltyDetails.length > 1 %}
            <tr>
              <td>Total Amount</td> 
              <td><strong>&pound;{{ totalAmount if totalAmount else 'N/A' }}</strong></td> 
              <td></td>
            </tr>
          {% endif %}
        </tbody>
      </table>
      <br />
      {% call components.form(action='/payment-code/' + paymentCode + '/' + penaltyType + '/payment', method='GET')  %}
        {% call components.formGroup() %}
          {{ components.heading(text='Payment by', tag='h3', size='medium') }}
          {{ components.radio(text='Card (external website)', value='card', id='pay-by-card', name='paymentType', checked="true") }}
          {{ components.radio(text='Cash', value='cash', id='pay-by-cash', name='paymentType') }}
          {{ components.radio(text='Cheque', value='cheque', id='pay-by-cheque', name='paymentType') }}
          {{ components.radio(text='Postal Order', value='postal', id='pay-by-postal', name='paymentType') }}
        {%- endcall %}
        {% if penaltyType == 'FPN' %}
          {{ components.button(text='Pay fixed penalties', type='submit') }}
        {% elif penaltyType == 'CDN' %}
          {{ components.button(text='Pay court deposits', type='submit') }}
        {% elif penaltyType == 'IM' %}
          {{ components.button(text='Pay immobilisation fee', type='submit') }}
        {% endif %}
      {%- endcall %}
    {%- endcall %}

  {%- endcall %}
  
{% endblock %}
