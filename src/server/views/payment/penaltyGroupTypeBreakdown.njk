{% extends 'layouts/default.layout.njk' %}

{% set pageTitle = 'DVSA Road Side Payment Portal' %}
{% set pageBreadcrumbItems = [
    { text: 'Home', url: '/' },
    { text: 'Payment Code', url: '/payment-code' },
    { text: 'Penalty Details' }
  ] 
%}
  
{% block content %}
  {% call components.gridRow() %}
    {% call components.columnTwoThirds() %}
      {{ components.heading(text='Pay fixed penalties and immobilisation fees', tag='h1', size='xlarge') }}
      <h3 class="heading-medium">
        {% if penaltyType == 'FPN' %}
          Pay fixed penalties
        {% elif penaltyType == 'CDN' %}
          Pay court deposits
        {% elif penaltyType == 'IM' %}
          Pay immobilisation fee
        {% endif %}
      </h3>
      {# Payment summary table #}
      <table>
        <thead>
          <tr>
            <th>Reference</th>
            <th>Amount</th>
            <th>Status</th>
          </tr>
        </thead>
        <tbody>
          {% for penalty in penaltyDetails %}
            {% set statusClass = 'confirmed' if penalty.status == 'PAID' else 'unconfirmed' %}
            <tr>
              <td>{{ penalty.formattedReference }}</td> 
              <td>&pound;{{ penalty.amount }}</td> 
              <td class="{{ statusClass }}"><strong>{{ penalty.status }}</strong></td>
            </tr>   
          {% endfor %}
          {% if penaltyDetails.length > 1 %}
            <tr>
              <td>Total Amount</td> 
              <td><strong>&pound;{{ totalAmount if totalAmount else 'N/A' }}</strong></td> 
              <td></td>
            </tr>
          {% endif %}
        </tbody>
      </table>
      <br />
      {% call components.form(action='/payment-code/' + paymentCode + '/' + penaltyType + '/payment', method='GET')  %}
        {% call components.formGroup() %}
          {{ components.heading(text='Payment by', tag='h3', size='medium') }}
          {{ components.radio(text='Card (external website)', value='card', id='pay-by-card', name='paymentType', checked="true") }}
          {{ components.radio(text='Cash', value='cash', id='pay-by-cash', name='paymentType') }}
          {{ components.radio(text='Cheque', value='cheque', id='pay-by-cheque', name='paymentType') }}
          {{ components.radio(text='Postal Order', value='postal', id='pay-by-postal', name='paymentType') }}
        {%- endcall %}
        {{ components.button(text='Continue to payment', type='submit') }}
      {%- endcall %}
    {%- endcall %}

    {% call components.columnOneThird() %}
    <aside class="govuk-related-items" role="complementary">
        <nav role="navigation" aria-labelledby="subsection-title">
          <ul class="font-xsmall">
            <li> {{ components.link(text='French', url='?clang=fr') if clang != 'fr' else components.link(text='English', url='?clang=en') }}</li>
            <li>{{ components.link(text='German', url='?clang=de') if clang != 'de' else components.link(text='English', url='?clang=en') }}</li>
            <li>{{ components.link(text='Polish', url='?clang=pl') if clang != 'pl' else components.link(text='English', url='?clang=en') }}</li>
            <li>{{ components.link(text='Spanish', url='?clang=es') if clang != 'es' else components.link(text='English', url='?clang=en') }}</li>
            <li>{{ components.link(text='Welsh', url='?clang=cy') if clang != 'cy' else components.link(text='English', url='?clang=en') }}</li>
          </ul>
        </nav>
      </aside>
    {%- endcall %}

  {%- endcall %}
  
{% endblock %}
